<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>enchant</title>
    <meta http-equiv="Content-Security-Policy" content="default-src * data:; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval'">
    <script src="components/loader.js"></script>
    <script type="text/javascript" src="components/enchant.js"></script>
    <link rel="stylesheet" href="components/loader.css">
    <link rel="stylesheet" href="css/style.css">
    <style type="text/css">
        body{margin: 0;}
    </style>
    <script>
        enchant();
        window.onload = function() {
            
            //■■■■■■■■■■■■■■■■■■■■
            //Coreシーン
            //■■■■■■■■■■■■■■■■■■■■
            core = new Core(768, 1024);
            core.fps = 25;
            core.preload('01_migitt.png','02_hidarite.png','haikei.png','burger.png','kao.png','damage3.mp3','swing1.mp3','famipop4.mp3','main.png');
            core.onload = function() {
            core.assets['famipop4.mp3'].play();
            core.assets['famipop4.mp3'].src.loop = true;

                                
                var haikei = new Sprite(768, 1024);
                haikei.image = core.assets['haikei.png'];
                haikei.x = 0;
                haikei.y = 0;
                haikei.scale(1, 1);
                core.rootScene.addChild(haikei);
                
                var hidarite = new Sprite(306, 996);
                hidarite.image = core.assets['02_hidarite.png'];
                hidarite.x = 470;
                hidarite.y = 463;
                hidarite.scale(0.5, 0.5);
                core.rootScene.addChild(hidarite);
                
                var burger = new Sprite(56, 276);
                burger.fps = 5;
                burger.frame = Math.floor(Math.random()*5+1);
                burger.image = core.assets['burger.png'];
                burger.x = Math.random()*(768-burger.width);
                burger.y = 0;
                burger.scale(0.8, 0.8);
                core.rootScene.addChild(burger);
                
                var migitt = new Sprite(306, 996);
                migitt.image = core.assets['01_migitt.png'];
                migitt.x = - 50;
                migitt.y = 463;
                migitt.scale(0.5, 0.5);
                core.rootScene.addChild(migitt);
                
                var kao = new Sprite(752, 283);
                kao.image = core.assets['kao.png'];
                kao.x = 0;
                kao.y = 880;
                kao.scale(1, 1);
                kao.gu_flg = 1;
                core.rootScene.addChild(kao);
                
                            /*
                            var gu = new Sprite(56, 276);
                            gu.fps = 5;
                            gu.frame = Math.floor(Math.random()*6);
                            gu.image = core.assets['burger.png'];
                            gu.x = Math.random()*(768-burger.width);
                            gu.y = 0;
                            gu.scale(0.8, 0.8);
                            core.rootScene.addChild(gu);
                            */
                            
                var infoLabel = new Label(kao.gu_flg);
                infoLabel.x = 0;
                infoLabel.y = 0;
                infoLabel.font = '100px sens-serif';
                core.rootScene.addChild(infoLabel);
                
                
                kao.addEventListener('touchstart',function(e) {
                        core.assets['swing1.mp3'].play();
                })

                kao.addEventListener('touchmove',function(e) {
                        this.x = e.x - this.width /2;
                        hidarite.x =  this.x + 100 + this.width /2;
                        migitt.x =  this.x + 290 - this.width /2;
                })
                
                kao.addEventListener('touchend',function(e) {
                        hidarite.x =  this.x - 90 + this.width /2;
                        migitt.x =  this.x  - 210 + this.width /2;
                        core.assets['damage3.mp3'].play();
                })
                
                
                kao.addEventListener('enterframe',function(e) {
                        burger.y += 10;
                        //gu.y += 10;
                        
                        if(burger.y == 1050) {                           
                            gu_flg = 0;
                            var gu = new Sprite(56, 276);
                            gu.fps = 5;
                            gu.frame = Math.floor(Math.random()*6);
                            gu.image = core.assets['burger.png'];
                            gu.x = Math.random()*(768-burger.width);
                            gu.y = 0;
                            gu.scale(0.8, 0.8);
                            core.rootScene.addChild(gu);
                            //core.rootScene.removeChild(burger);
                        }
                    
                       if(kao.gu_flg == 0) {
                            gu.y += 10;
                        }
                     
                        
                })
                
                
                
                
                 // 二つ目のシーン
                var main = new Scene();
                
                var main = new Sprite(798, 1049);
                main.image = core.assets['main.png'];
                main.x = 0;
                main.y = 0;
                main.scale(1, 1);
                //core.rootScene.addChild(main);
                 core.pushScene(main);
                
        
        
                // 画面をクリック(タッチ)した時の処理
                kao.addEventListener('touchstart', function() {
                    core.pushScene(main);
                });
            }
            core.start();
            
        }
    </script>
</head>
<body>
    <br>
    This is a template for Monaca app.<br>
</body>
</html>
